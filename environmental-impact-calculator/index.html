<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="script/nouislider.min.js"></script>
<script src="script/wNumb.min.js"></script>
<link rel="stylesheet" href="css/nouislider.min.css" />
<style>

.slidecontainer {
  width: 90%;
}

.noUi-target {
  margin-top: 50px;
  margin-bottom: 50px;
}

h1 {
  font-family: sans-serif;
  font-size: 36pt;
  color: #2d6;
}
h2 {
  font-family: sans-serif;
  color: #666;
}
h3 {
  font-family: sans-serif;
  color: #777;
}


</style>
</head>
<body>

<h1>Insurance Risk Survey Environmental Impact Calculator</h1>

<div class="slidecontainer">
  <h2>Total number of insured properties (* 1,000,000)</h2>
  <div id="sli_n_insu"></div>
  <h2>Properties surveyed per year (percent)</h2>
  <div id="sli_frac_sur"></div>
  <h2>Avg. total distance travelled per survey (km)</h2>
  <div id="sli_dist_per_sur"></div>
  <h2>Hotel nights per 100 surveys</h2>
  <div id="sli_n_hotel"></div>
  <h2>Percentage of trips by air travel</h2>
  <div id="sli_frac_air"></div>
  <h2>Avg. carbon footprint car (gCO2e/km)</h2>
  <div id="sli_cf_car"></div>
  <h2>Avg. carbon footprint air travel (gCO2e/passenger/km)</h2>
  <div id="sli_cf_air"></div>
  <h2>Avg. carbon footprint hotel (kgCO2e/night)</h2>
  <div id="sli_cf_hotel"></div>
  <h2>Total carbon footprint: <span id="result" style="color:#f00;"></span> tonnes of CO2e per year.</h2>
</div>

<div id="multislider"></div>

<h3>End notes:</h3>
<ol>
<li>About 500,000 insured objects in the UK are risk-surveyed each year, and about 5% of all insured property surveyed every 2-3 years.</li>
<li>
Carbon footprint estimates of different types of vehicles (include life-cycle of car, emissions from fuel production, and exhaust emissions) 
<ul>
<li>Petrol: 240 gCO2e/km</li>
<li>Diesel: 210  gCO2e/km</li>
<li>Electric (100% renewable): 80 gCO2e/km</li>
<li>Electric (mixed): 180 gCO2e/km</li>
<li>Electric (100% coal): 310 gCO2e/km</li>
</ul>

Source: <a target="_blank" href="https://www.eea.europa.eu/signals/signals-2017/infographics/range-of-life-cycle-co2/view">eea.europa.eu</a> (no calculation details)
</li>
<li>
Carbon footprint of hotel (includes food, drinks, bed, breakfast)
<ul>
<li>low carbon: 3kg CO2e / night</li>
<li>average: 24kg CO2e / night</li>
<li>high carbon: 60kg CO2e / night</li>
</ul>
Catering industry emits on average 400g CO2e per pound spent (pubs, restaurants, hotels).  Source: Berners-Lee "How Bad Are Bananas? - The Carbon Footprint of Everything" (2011)
</li>
<li><a href="https://www.sciencedirect.com/science/article/pii/S0959652611002435" target='_blank'>Filimonau et al (2011)</a> report 11.7 and 8.3 kg CO2e/guest/night on detailed analysis of 2 big UK hotels</li>
<li>UK average hotel carbon footprint 34.3 kgCO2e/guest/night according to <a href="https://www.sciencedirect.com/science/article/abs/pii/S0959652611002435" target='_blank'>Chenoweth (2009)</a> but without providing calculation details</li>
<li>Domestic air travel UK: 255g CO2e / km / passenger <a href="https://www.gov.uk/government/publications/greenhouse-gas-reporting-conversion-factors-2019" target='_blank'>UK Department for Business, Energy & Industrial Strategy: Greenhouse Gas reporting conversion factors 2019</a></li>
<li>For air travel, emission factors are multiplied by a factor of about 2 compared to ground transport to account for the effect of emitting greenhouse gases directly into the stratosphere. This has been done in the estimate above.</li>
<li>The UKDBEIS estimates include well-to-tank production costs of kerosine. I did not find estimates of total life-cycle carbon footprint for air travel as are included in the car travel estimates. Assuming a multiplier of 1.5 compared to exhaust and fuel production only, we arrive at an estimate of <b>375-500g CO2e / km / passenger</b> for domestic air travel.
<li>More recent air travel reference: <a href="https://www.sciencedirect.com/science/article/pii/S1352231020305689" target="_blank">Lee et al (2021)</a></li>
<li>A big UK university has a carbon footprint of about 50,000 tons CO2e per year </li>
</ol>




<script>
var sli_n_insu = document.getElementById('sli_n_insu');
var sli_frac_sur = document.getElementById('sli_frac_sur');
var sli_dist_per_sur = document.getElementById('sli_dist_per_sur');
var sli_frac_air = document.getElementById('sli_frac_air');
var sli_n_hotel = document.getElementById('sli_n_hotel');
var sli_cf_car = document.getElementById('sli_cf_car');
var sli_cf_air = document.getElementById('sli_cf_air');
var sli_cf_hotel = document.getElementById('sli_cf_hotel');

noUiSlider.create(sli_n_insu, {
    start: [9, 10],
    connect: true,
    step: 0.1,
    range: {
        'min': 1,
        'max': 20
    },
    pips: {mode: 'range', density: 3},
    behaviour: 'drag',
    tooltips: [wNumb({decimals:1}), wNumb({decimals:1})]

});

noUiSlider.create(sli_frac_sur, {
    start: [3, 7],
    connect: true,
    range: {
        'min': 0,
        'max': 100
    },
    pips: {mode: 'range', density: 3},
    behaviour: 'drag',
    tooltips: [wNumb({decimals:1}), wNumb({decimals:1})]
});

noUiSlider.create(sli_frac_air, {
    start: [3, 7],
    connect: true,
    range: {
        'min': 0,
        'max': 100
    },
    pips: {mode: 'range', density: 3},
    behaviour: 'drag',
    tooltips: [wNumb({decimals:1}), wNumb({decimals:1})]
});

noUiSlider.create(sli_dist_per_sur, {
    start: [250, 300],
    connect: true,
    range: {
        'min': 0,
        'max': 500
    },
    pips: {mode: 'range', density: 3},
    behaviour: 'drag',
    tooltips: [wNumb({decimals:1}), wNumb({decimals:1})]
});

noUiSlider.create(sli_n_hotel, {
    start: [5, 10],
    connect: true,
    range: {
        'min': 0,
        'max': 100
    },
    pips: {mode: 'range', density: 3},
    behaviour: 'drag',
    tooltips: [wNumb({decimals:1}), wNumb({decimals:1})]
});

noUiSlider.create(sli_cf_car, {
    start: [200, 300],
    connect: true,
    range: {
        'min': 0,
        'max': 500
    },
    pips: {mode: 'range', density: 3},
    behaviour: 'drag',
    tooltips: [wNumb({decimals:1}), wNumb({decimals:1})]
});

noUiSlider.create(sli_cf_air, {
    start: [375, 500],
    connect: true,
    range: {
        'min': 0,
        'max': 1000
    },
    pips: {mode: 'range', density: 3},
    behaviour: 'drag',
    tooltips: [wNumb({decimals:1}), wNumb({decimals:1})]
});

noUiSlider.create(sli_cf_hotel, {
    start: [20, 30],
    connect: true,
    range: {
        'min': 0,
        'max': 100
    },
    pips: {mode: 'range', density: 3},
    behaviour: 'drag',
    tooltips: [wNumb({decimals:1}), wNumb({decimals:1})]
});


update_result = function() {
  res = ['', '']  
  var n_insu = sli_n_insu.noUiSlider.get().map(parseFloat).map((x)=>x*1000000);
  var frac_sur = sli_frac_sur.noUiSlider.get().map(parseFloat).map((x)=>x/100);
  var dist_per_sur = sli_dist_per_sur.noUiSlider.get().map(parseFloat);
  var n_hotel = sli_n_hotel.noUiSlider.get().map(parseFloat).map((x)=>x/100);
  var cf_car = sli_cf_car.noUiSlider.get().map(parseFloat);
  var cf_air = sli_cf_air.noUiSlider.get().map(parseFloat);
  var cf_hotel = sli_cf_hotel.noUiSlider.get().map(parseFloat).map((x)=>x*1000);
  var frac_air = sli_frac_air.noUiSlider.get().map(parseFloat).map((x)=>x/100);


  for (i = 0; i < 2; i++) {
    var rr = n_insu[i] * frac_sur[i] * (
               dist_per_sur[i] * (frac_air[i] * cf_air[i] + 
                                  (1 - frac_air[i]) * cf_car[i]) + 
               n_hotel[i] * cf_hotel[i]);
    rr /= 1000000;
    rr = Math.round(rr);
    res[i] = rr.toLocaleString();
  }
  document.getElementById("result").innerHTML = res.join(' - ');
}

sli_n_insu.noUiSlider.on('update', update_result);
sli_frac_sur.noUiSlider.on('update', update_result);
sli_dist_per_sur.noUiSlider.on('update', update_result);
sli_n_hotel.noUiSlider.on('update', update_result);
sli_cf_car.noUiSlider.on('update', update_result);
sli_cf_hotel.noUiSlider.on('update', update_result);
sli_cf_air.noUiSlider.on('update', update_result);
sli_frac_air.noUiSlider.on('update', update_result);

</script>

</body>
</html>



